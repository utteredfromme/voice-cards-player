<script>
  async function loadAudio() {
    const params = new URLSearchParams(location.search);
    const cardId = params.get("card");

    if (!cardId) {
      document.getElementById("status").innerText = "Missing card ID in URL.";
      return;
    }

    try {
      const response = await fetch("audio-map.json");
      if (!response.ok) throw new Error("Load failed");

      const map = await response.json();

      const fileId = map[cardId];
      if (!fileId) {
        document.getElementById("status").innerText = "Card ID not found.";
        return;
      }

      const audioUrl = `https://drive.google.com/uc?export=download&id=${fileId}`;
      const audio = document.createElement("audio");
      audio.controls = true;
      audio.src = audioUrl;
      document.getElementById("player").appendChild(audio);

      document.getElementById("status").style.display = "none";
    } catch (e) {
      console.error(e);
      document.getElementById("status").innerText = `Error loading list: ${e.message}`;
    }
  }

  window.onload = loadAudio;
</script>
